<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fraction Operations Practice</title>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 40px auto;
      max-width: 700px;
      padding: 20px;
      background-color: #f9fafb;
      color: #333;
      border: 1px solid #ddd;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #2c3e50;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input[type="number"], input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    input[type="checkbox"] {
      margin-right: 6px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 18px;
      margin: 8px 0;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #45a049;
    }
    .feedback {
      margin-top: 20px;
      font-weight: bold;
      font-size: 1.2em;
      text-align: center;
    }
    #question {
      margin: 20px 0;
      font-size: 1.5em;
      text-align: center;
    }
    @media (max-width: 600px) {
      body {
        margin: 20px 10px;
        padding: 15px;
      }
      h1 {
        font-size: 1.5em;
      }
      button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Practice Fraction Operations</h1>

  <label>Choose operations:</label>
  <input type="checkbox" id="addition" checked> Addition
  <input type="checkbox" id="subtraction" checked> Subtraction
  <input type="checkbox" id="multiplication" checked> Multiplication
  <input type="checkbox" id="division" checked> Division<br><br>

  <label>Choose fraction types:</label>
  <input type="checkbox" id="proper" checked> Proper Fractions
  <input type="checkbox" id="improper" checked> Improper Fractions
  <input type="checkbox" id="mixed" checked> Mixed Numbers<br><br>

  <button onclick="generateFractionQuestion()">Generate Question</button><br><br>

  <div id="question"></div><br>

  <input type="text" id="userAnswer" placeholder="Enter your answer (e.g., 5/4)">
  <div style="font-size: 0.9em; margin-bottom: 10px;">
  (Please fully simplify your answer. Use integers if the answer is a whole number.)
  </div>
  <button onclick="checkFractionAnswer()">Check Answer</button>
  <br><br>

  <div class="feedback" id="feedback"></div><br>

  <button id="giveUpButton" onclick="giveUp()" style="display:none;">Give Up</button>

  <script>
    let currentQuestion = {};
    let correctAnswerLatex = '';
    let attempts = 0;

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateFraction(type) {
      let numerator, denominator;
      if (type === "proper") {
        denominator = randomInt(2, 9);
        numerator = randomInt(1, denominator - 1);
      } else if (type === "improper") {
        denominator = randomInt(2, 9);
        numerator = randomInt(denominator + 1, denominator * 2);
      } else { // mixed number
        let whole = randomInt(1, 5);
        denominator = randomInt(2, 9);
        numerator = randomInt(1, denominator - 1);
        numerator += whole * denominator;
      }
      return { numerator, denominator };
    }

    function generateFractionQuestion() {
      const operations = [];
      if (document.getElementById('addition').checked) operations.push('+');
      if (document.getElementById('subtraction').checked) operations.push('-');
      if (document.getElementById('multiplication').checked) operations.push('\\times');
      if (document.getElementById('division').checked) operations.push('\\div');

      const types = [];
      if (document.getElementById('proper').checked) types.push('proper');
      if (document.getElementById('improper').checked) types.push('improper');
      if (document.getElementById('mixed').checked) types.push('mixed');

      const op = operations[Math.floor(Math.random() * operations.length)];
      const type1 = types[Math.floor(Math.random() * types.length)];
      const type2 = types[Math.floor(Math.random() * types.length)];

      const frac1 = generateFraction(type1);
      const frac2 = generateFraction(type2);

      currentQuestion = { frac1, frac2, op };
      attempts = 0;
      document.getElementById('giveUpButton').style.display = 'none';

      const questionLatex = (op === '\\div')
        ? `\\( \\frac{${frac1.numerator}}{${frac1.denominator}} \\div \\frac{${frac2.numerator}}{${frac2.denominator}} = \\ ? \\)`
        : `\\( \\frac{${frac1.numerator}}{${frac1.denominator}} ${op} \\frac{${frac2.numerator}}{${frac2.denominator}} = \\ ? \\)`;

      document.getElementById('question').innerHTML = questionLatex;
      document.getElementById('userAnswer').innerText = '';
      document.getElementById('feedback').innerText = '';
      MathJax.Hub.Queue(["Typeset", MathJax.Hub, "question"]);

      // Precalculate correct answer
      let n1 = frac1.numerator, d1 = frac1.denominator;
      let n2 = frac2.numerator, d2 = frac2.denominator;
      let answerNum, answerDen;

      if (op === '+') {
        answerNum = n1 * d2 + n2 * d1;
        answerDen = d1 * d2;
      } else if (op === '-') {
        answerNum = n1 * d2 - n2 * d1;
        answerDen = d1 * d2;
      } else if (op === '\\times') {
        answerNum = n1 * n2;
        answerDen = d1 * d2;
      } else if (op === '\\div') {
        answerNum = n1 * d2;
        answerDen = d1 * n2;
      }

      currentQuestion.correctNumerator = answerNum;
      currentQuestion.correctDenominator = answerDen;
      correctAnswerLatex = `\\( \\frac{${answerNum}}{${answerDen}} \\)`;
    }

    function checkFractionAnswer() {
  const userInput = document.getElementById('userAnswer').value.trim();
  const correctNum = currentQuestion.correctNumerator;
  const correctDen = currentQuestion.correctDenominator;

  // Simplify the correct answer
  function gcd(a, b) {
    return b ? gcd(b, a % b) : a;
  }
  const divisor = gcd(correctNum, correctDen);
  const simplifiedNum = correctNum / divisor;
  const simplifiedDen = correctDen / divisor;

  const parts = userInput.split('/');

  let userNum, userDen;

  if (parts.length === 1) {
    // User entered integer
    userNum = parseInt(parts[0]);
    userDen = 1;
  } else if (parts.length === 2) {
    userNum = parseInt(parts[0]);
    userDen = parseInt(parts[1]);
  } else {
    document.getElementById('feedback').innerText = "Invalid answer format.";
    return;
  }

  if (userNum * simplifiedDen === userDen * simplifiedNum) {
    document.getElementById('feedback').innerText = 'Correct! Well done!';
    document.getElementById('giveUpButton').style.display = 'none';
  } else {
    attempts++;
    document.getElementById('feedback').innerText = 'Wrong. Make sure to simplify!';
    if (attempts >= 3) {
      document.getElementById('giveUpButton').style.display = 'inline-block';
    }
  }
}


    function giveUp() {
  const n1 = currentQuestion.frac1.numerator;
  const d1 = currentQuestion.frac1.denominator;
  const n2 = currentQuestion.frac2.numerator;
  const d2 = currentQuestion.frac2.denominator;
  const op = currentQuestion.op;

  function gcd(a, b) {
    return b ? gcd(b, a % b) : a;
  }

  let explanation = '';

  if (op === '+') {
    const commonDen = d1 * d2;
    const adjustedN1 = n1 * d2;
    const adjustedN2 = n2 * d1;
    const sumNum = adjustedN1 + adjustedN2;
    const divisor = gcd(sumNum, commonDen);
    const simplifiedNum = sumNum / divisor;
    const simplifiedDen = commonDen / divisor;

    explanation = `
      Step 1: Find a common denominator: ${d1} × ${d2} = ${commonDen}.<br><br>
      Step 2: Rewrite the fractions:<br>
      \\( \\frac{${n1}}{${d1}} + \\frac{${n2}}{${d2}} = \\frac{${adjustedN1}}{${commonDen}} + \\frac{${adjustedN2}}{${commonDen}} \\)<br><br>
      Step 3: Add the fractions:<br>
      \\( \\frac{${adjustedN1} + ${adjustedN2}}{${commonDen}} = \\frac{${sumNum}}{${commonDen}} \\)<br><br>
      Step 4: Simplify the answer:<br>
      \\( \\frac{${sumNum}}{${commonDen}} = \\frac{${simplifiedNum}}{${simplifiedDen}} \\)
    `;
  }

  else if (op === '-') {
    const commonDen = d1 * d2;
    const adjustedN1 = n1 * d2;
    const adjustedN2 = n2 * d1;
    const diffNum = adjustedN1 - adjustedN2;
    const divisor = gcd(diffNum, commonDen);
    const simplifiedNum = diffNum / divisor;
    const simplifiedDen = commonDen / divisor;

    explanation = `
      Step 1: Find a common denominator: ${d1} × ${d2} = ${commonDen}.<br><br>
      Step 2: Rewrite the fractions:<br>
      \\( \\frac{${n1}}{${d1}} - \\frac{${n2}}{${d2}} = \\frac{${adjustedN1}}{${commonDen}} - \\frac{${adjustedN2}}{${commonDen}} \\)<br><br>
      Step 3: Subtract the fractions:<br>
      \\( \\frac{${adjustedN1} - ${adjustedN2}}{${commonDen}} = \\frac{${diffNum}}{${commonDen}} \\)<br><br>
      Step 4: Simplify the answer:<br>
      \\( \\frac{${diffNum}}{${commonDen}} = \\frac{${simplifiedNum}}{${simplifiedDen}} \\)
    `;
  }

  else if (op === '\\times') {
    const mulNum = n1 * n2;
    const mulDen = d1 * d2;
    const divisor = gcd(mulNum, mulDen);
    const simplifiedNum = mulNum / divisor;
    const simplifiedDen = mulDen / divisor;

    explanation = `
      Step 1: Multiply the numerators and the denominators:<br>
      \\( \\frac{${n1}}{${d1}} \\times \\frac{${n2}}{${d2}} = \\frac{${mulNum}}{${mulDen}} \\)<br><br>
      Step 2: Simplify the answer:<br>
      \\( \\frac{${mulNum}}{${mulDen}} = \\frac{${simplifiedNum}}{${simplifiedDen}} \\)
    `;
  }

  else if (op === '\\div') {
    const flipN2 = d2;
    const flipD2 = n2;
    const divNum = n1 * flipN2;
    const divDen = d1 * flipD2;
    const divisor = gcd(divNum, divDen);
    const simplifiedNum = divNum / divisor;
    const simplifiedDen = divDen / divisor;

    explanation = `
      Step 1: Rewrite division as multiplication by the reciprocal:<br>
      \\( \\frac{${n1}}{${d1}} \\div \\frac{${n2}}{${d2}} = \\frac{${n1}}{${d1}} \\times \\frac{${flipN2}}{${flipD2}} \\)<br><br>
      Step 2: Multiply the numerators and the denominators:<br>
      \\( \\frac{${n1} \\times ${flipN2}}{${d1} \\times ${flipD2}} = \\frac{${divNum}}{${divDen}} \\)<br><br>
      Step 3: Simplify the answer:<br>
      \\( \\frac{${divNum}}{${divDen}} = \\frac{${simplifiedNum}}{${simplifiedDen}} \\)
    `;
  }

  document.getElementById('feedback').innerHTML = explanation;
  MathJax.Hub.Queue(["Typeset", MathJax.Hub, "feedback"]);
}


  </script>
</body>
</html>
